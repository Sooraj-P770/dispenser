<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width,initial-scale=1" />
    <title>Medical Dispenser Robot</title>
    <link rel="stylesheet" href="style.css">

    <!-- ================= FIREBASE INITIALIZATION ================= -->
    <script type="module">
        import { initializeApp } from "https://www.gstatic.com/firebasejs/10.13.0/firebase-app.js";
        import { getFirestore } from "https://www.gstatic.com/firebasejs/10.13.0/firebase-firestore.js";

        const firebaseConfig = {
            apiKey: "AIzaSyCDOvjebFLwmNnUskeLopBqT7vX4p0zkQE",
            authDomain: "medicine-6f6b4.firebaseapp.com",
            projectId: "medicine-6f6b4",
            storageBucket: "medicine-6f6b4.firebasestorage.app",
            messagingSenderId: "965552398904",
            appId: "1:965552398904:web:746f3fb0ddc31a27d83ccd",
            measurementId: "G-53T2HKMV3L"
        };

        // Initialize Firebase app
        const app = initializeApp(firebaseConfig);

        // Expose services globally
        window.db = getFirestore(app);
        window.firebaseApp = app;   // ðŸ”´ CRITICAL FOR RTDB CONNECTION
    </script>
</head>

<body>

<header class="topnav">
    <div class="logo">Medical Dispenser</div>
    <nav>
        <a onclick="showScreen('welcomeScreen')">Home</a>
        <a onclick="showScreen('aboutScreen')">About</a>
        <a onclick="showScreen('contactScreen')">Contact</a>
        <a class="cta" onclick="showScreen('loginScreen')">Sign In</a>
    </nav>
</header>

<main>

    <!-- HOME SCREEN -->
    <section id="welcomeScreen" class="screen active home-layout">
        <div class="home-left">
            <h1>Automated Medical<br>Dispenser Robot</h1>
            <p class="lead">
                Safe, reliable medicine delivery designed to assist nurses and improve patient care.
            </p>
            <div class="hero-buttons">
                <button onclick="showScreen('loginScreen')">Get Started</button>
                <button class="outline" onclick="showScreen('aboutScreen')">Learn More</button>
            </div>
        </div>

        <div class="home-right">
            <div class="robot-card">
                <div class="robot">
                    <div class="robot-head">
                        <div class="eye left"></div>
                        <div class="eye right"></div>
                    </div>
                    <div class="robot-body"></div>
                    <div class="robot-base"></div>
                </div>
                <p class="robot-caption">Your assistant on wheels ðŸ¤–</p>
            </div>
        </div>
    </section>

    <!-- LOGIN -->
    <section id="loginScreen" class="screen">
        <div class="card">
            <h2>Welcome, Nurse</h2>
            <p>Click Login to enter username & password</p>
            <button onclick="revealLogin()">Login</button>

            <div id="loginForm" class="hidden-block">
                <input id="username" type="text" placeholder="Username">
                <input id="password" type="password" placeholder="Password">

                <div class="form-actions">
                    <button onclick="attemptLogin()">Submit</button>
                    <button class="outline" onclick="showScreen('welcomeScreen')">Cancel</button>
                </div>
            </div>
        </div>
    </section>

    <!-- ABOUT -->
    <section id="aboutScreen" class="screen">
        <div class="card">
            <h2>About</h2>
            <p>This robot helps deliver medicines to patients automatically and enables nurses to update prescriptions remotely.</p>
            <button class="outline" onclick="showScreen('welcomeScreen')">Back</button>
        </div>
    </section>

    <!-- CONTACT -->
    <section id="contactScreen" class="screen">
        <div class="card">
            <h2>Contact</h2>
            <p>Email: support@robotcare.com</p>
            <p>Phone: +91 98765 43210</p>
            <button class="outline" onclick="showScreen('welcomeScreen')">Back</button>
        </div>
    </section>

    <!-- DASHBOARD -->
    <section id="dashboardScreen" class="screen">
        <div class="card">
            <h2>Robot Dashboard</h2>
            <p>Status: <strong id="robotStatus">Idle</strong></p>
            <p>Battery: <span id="robotBattery">92%</span></p>

           

            <div class="form-actions">
                <button onclick="showScreen('bedScreen')">Add Patients</button>
                <button class="outline" onclick="logout()">Logout</button>
            </div>
        </div>
    </section>

    <!-- SELECT BED -->
    <section id="bedScreen" class="screen">
        <div class="card">
            <h2>Select Bed</h2>
            <div class="bed-grid">
                <button onclick="openPatient(1, 'John')">Bed 1 â€” John</button>
                <button onclick="openPatient(2, 'Riya')">Bed 2 â€” Riya</button>
                <button onclick="openPatient(3, 'Akash')">Bed 3 â€” Akash</button>
                <button onclick="openPatient(4, 'Mary')">Bed 4 â€” Mary</button>
            </div>
            <div class="form-actions">
                <button class="outline" onclick="showScreen('dashboardScreen')">Back to Dashboard</button>
            </div>
        </div>
    </section>

    <!-- PATIENT FORM -->
    <section id="patientScreen" class="screen">
        <div class="card">
            <h2 id="pTitle">Patient Info</h2>

            <label class="lbl">Patient Name</label>
            <input id="pName" type="text">

            <label class="lbl">Select Medicine to Add</label>
            <select id="medicineSelect">
                <option value="">-- Select Medicine --</option>
                <option value="Paracetamol">Paracetamol</option>
                <option value="Amoxicillin">Amoxicillin</option>
                <option value="Aspirin">Aspirin</option>
                <option value="Ibuprofen">Ibuprofen</option>
            </select>

            <button class="small-btn" onclick="openMedicineScreen()">Add Medicine Details</button>

            <div id="medicineList"></div>

            <div class="form-actions">
                <button onclick="savePatient()">Save Patient</button>
                <button class="outline" onclick="showScreen('bedScreen')">Cancel</button>
            </div>
        </div>
    </section>

    <!-- MEDICINE DETAILS -->
    <section id="medicineScreen" class="screen">
        <div class="card">
            <h2>Medicine Details</h2>

            <label class="lbl">Medicine Name</label>
            <input id="mName" type="text" readonly>

            <label class="lbl">Number of Tablets</label>
            <div class="dose-counter">
                <button onclick="changeDose(-1)">âˆ’</button>
                <span id="doseCount">1</span>
                <button onclick="changeDose(1)">+</button>
            </div>

            <label class="lbl">Time / Schedule</label>
            <input id="mTime" type="text">

            <div class="form-actions">
                <button onclick="saveMedicine()">Save Medicine</button>
                <button class="outline" onclick="showScreen('patientScreen')">Cancel</button>
            </div>
        </div>
    </section>

    <!-- PATIENT GREETING -->
    <section id="patientGreetingScreen" class="screen">
        <div class="card">
            <h2>ðŸ¤– Robot Arrived</h2>
            <p id="greetingText"></p>

            <div class="patient-summary">
                <p><strong>Name:</strong> <span id="pgName"></span></p>
                <div id="pgMedList"></div>
            </div>

            <div class="form-actions">
                <button onclick="confirmMedicine(true)">Yes, I received</button>
                <button class="outline" onclick="confirmMedicine(false)">Not yet / Problem</button>
            </div>
        </div>
    </section>

    <!-- THANK YOU -->
    <section id="thankScreen" class="screen">
        <div class="card">
            <h2>ðŸŽ‰ Thank you!</h2>
            <p id="finalMsg"></p>
            <button onclick="showScreen('dashboardScreen')">Back to Dashboard</button>
        </div>
    </section>

</main>

<!-- MAIN WEBSITE LOGIC -->
<script type="module" src="script.js"></script>

</body>
</html>
